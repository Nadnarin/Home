<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Portal</title>
  <style>
    body { margin:0; font-family:Arial, sans-serif; background:#f5f5f5; }
    nav{ background:#222; padding:12px; display:flex; gap:10px; position:sticky; top:0; z-index:1000;}
    nav button{ background:#444; color:#fff; padding:10px 16px; border:none; border-radius:6px; cursor:pointer; }
    nav button:hover{ background:#666 }
    #frame-wrap{ height: calc(100vh - 60px); background:#ddd; }
    iframe{ width:100%; height:100%; border:none; background:#fff; }
  </style>
</head>
<body>
  <nav>
    <button onclick="navigate('https://your-user.github.io/app1/')">App 1</button>
    <button onclick="navigate('https://your-user.github.io/app2/')">App 2</button>
    <button onclick="navigate('https://your-user.github.io/app3/')">App 3</button>
  </nav>

  <div id="frame-wrap">
    <iframe id="app-iframe" src="" sandbox="allow-scripts allow-same-origin"></iframe>
  </div>

  <script>
    const iframe = document.getElementById('app-iframe');

    // โหลด app และเก็บใน hash เพื่อให้ refresh ไม่หาย
    function navigate(url) {
      iframe.src = url;
      history.replaceState(null, '', '#'+encodeURIComponent(url));
    }

    // ถ้ามี hash ให้โหลด
    if (location.hash) {
      const url = decodeURIComponent(location.hash.substring(1));
      iframe.src = url;
    } else {
      // โหลด default app
      iframe.src = 'https://your-user.github.io/app1/';
      history.replaceState(null, '', '#'+encodeURIComponent(iframe.src));
    }

    // รับข้อความจาก iframe (postMessage) เพื่อปรับความสูงอัตโนมัติ
    window.addEventListener('message', (ev) => {
      // ไม่บังคับตรวจ origin เพื่อความยืดหยุ่น (แนะนำให้ตรวจ origin ใน production)
      try {
        const data = typeof ev.data === 'string' ? JSON.parse(ev.data) : ev.data;
        if (data && data.type === 'mf-height' && Number.isFinite(data.height)) {
          // ปรับความสูงของ iframe ให้พอดี (ถ้rame อยู่ใน #frame-wrap ตั้งเป็น auto height)
          iframe.style.height = data.height + 'px';
        }
      } catch (e) {
        // ignore
      }
    }, false);

    // fallback: ถ้าไม่ได้รับ postMessage เราจะใช้ 100vh ซึ่งเป็นค่าเริ่มต้น
  </script>
</body>
</html>
